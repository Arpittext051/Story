This is first version of chapter3.